___INFO___

{
  "displayName": "Carbon",
  "description": "Carbon is a data management platform that understands customer behaviour and intent",
  "securityGroups": [],
  "id": "cvt_temp_public_id",
  "type": "TAG",
  "version": 1,
  "brand": {
    "thumbnail": "data:image/png;base64,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",
    "displayName": "Carbon",
    "id": "carbon_brand"
  },
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "displayName": "Carbon Partner ID",
    "simpleValueType": true,
    "name": "parentid",
    "type": "TEXT"
  }
]


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "cca"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "cca.q"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://carbon-cdn.ccgateway.net/script*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "isRequired": true
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const createArgumentsQueue = require('createArgumentsQueue');
const injectScript = require('injectScript');
const encodeUriComponent = require('encodeUriComponent');
const parentId = encodeUriComponent(data.parentid);
const cca = createArgumentsQueue('cca', 'cca.q');
const getUrl = require('getUrl');
let site = getUrl('host', false);
let url = 'https://carbon-cdn.ccgateway.net/script?id=' + site + '&parentid=' + parentId;
injectScript(url, data.gtmOnSuccess, data.gtmOnFailure, url);


___NOTES___

Created on 31/07/2019, 17:23:01
